# 小红书发布功能测试指南

本目录包含了用于测试小红书自动发布功能的测试脚本。

## 📁 文件说明

### 测试脚本
- `test_xiaohongshu_poster.py` - 完整的测试套件，包含所有功能测试
- `quick_test_poster.py` - 快速测试脚本，简单易用
- `xiaohongshu_poster.py` - 主要的小红书发布功能类

### 配置文件
- `config.py` - 配置文件，包含浏览器设置等参数

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install selenium webdriver-manager pillow
```

### 2. 选择测试方式

#### 方式一：快速测试（推荐新手）
```bash
python quick_test_poster.py
```

这个脚本提供两个选项：
- **完整发布测试**：实际发布帖子到小红书
- **草稿保存测试**：只保存草稿到文件，不实际发布

#### 方式二：完整测试套件
```bash
python test_xiaohongshu_poster.py
```

这个脚本会运行完整的测试套件，包括：
- 海报类初始化测试
- 浏览器驱动设置测试
- 登录状态检测测试
- 草稿保存功能测试
- 完整发布流程测试

## 📋 测试内容

### 基础功能测试
1. **类初始化测试**：验证 XiaohongshuPoster 类能否正常创建
2. **浏览器驱动测试**：验证 Chrome 浏览器驱动是否正常工作
3. **登录状态检测**：验证能否正确检测小红书登录状态
4. **草稿保存测试**：验证草稿保存功能是否正常

### 完整发布流程测试
1. **登录小红书**：自动检测登录状态，如未登录会提示手动登录
2. **导航到发布页面**：点击发布按钮进入发布页面
3. **点击上传图文**：按照正确流程点击上传图文按钮
4. **点击上传图片**：点击上传图片按钮
5. **上传图片文件**：上传指定的图片文件
6. **填写标题**：输入帖子标题
7. **填写内容**：输入帖子内容和话题标签
8. **发布帖子**：点击发布按钮完成发布

## ⚠️ 重要注意事项

### 1. 登录要求
- 测试前需要确保已经登录小红书账号
- 如果未登录，脚本会提示手动登录
- 登录后脚本会自动检测并继续执行

### 2. 图片文件
- 测试脚本会自动创建测试图片或使用现有图片
- 支持的图片格式：JPG、JPEG、PNG、GIF
- 图片文件应放在 `screenshots/` 目录下

### 3. 发布风险
- **完整发布测试会实际发布帖子到小红书**
- 建议使用测试账号进行测试
- 发布前会要求用户确认

### 4. 网络环境
- 需要稳定的网络连接
- 建议使用国内网络环境
- 如遇到网络问题，脚本会自动重试

## 📊 测试结果

### 日志文件
- 测试过程中会生成 `test_poster.log` 日志文件
- 包含详细的测试步骤和错误信息
- 可用于问题排查和调试

### 输出文件
- 草稿测试会生成 `test_output/` 目录
- 包含保存的草稿文件
- 可用于验证内容格式是否正确

## 🔧 故障排除

### 常见问题

1. **ChromeDriver 问题**
   ```
   错误：ChromeDriver 初始化失败
   解决：确保已安装 Chrome 浏览器，脚本会自动下载对应版本的 ChromeDriver
   ```

2. **登录检测失败**
   ```
   错误：未检测到登录状态
   解决：手动登录小红书，然后重新运行测试
   ```

3. **元素查找失败**
   ```
   错误：未找到发布按钮/上传按钮等
   解决：小红书页面结构可能发生变化，需要更新选择器
   ```

4. **图片上传失败**
   ```
   错误：图片文件不存在或格式不支持
   解决：确保图片文件存在且格式正确
   ```

### 调试技巧

1. **查看详细日志**
   ```bash
   tail -f test_poster.log
   ```

2. **手动验证元素**
   - 打开浏览器开发者工具
   - 检查页面元素的选择器是否正确

3. **分步测试**
   - 先运行基础测试，确认环境正常
   - 再运行完整发布测试

## 📝 自定义测试

### 修改测试内容
编辑测试脚本中的以下变量：
```python
test_title = "你的测试标题"
test_content = "你的测试内容"
test_topics = ["#话题1", "#话题2"]
test_images = ["path/to/image1.jpg", "path/to/image2.png"]
```

### 修改配置参数
编辑 `config.py` 文件：
```python
BROWSER_HEADLESS = False  # 设置为 True 可启用无头模式
BROWSER_TIMEOUT = 10      # 浏览器超时时间
```

## 🤝 贡献

如果发现 bug 或有改进建议，请：
1. 查看日志文件了解详细错误信息
2. 提供复现步骤
3. 提交 issue 或 pull request

## 📄 许可证

本项目仅供学习和测试使用，请遵守小红书的使用条款和相关法律法规。 